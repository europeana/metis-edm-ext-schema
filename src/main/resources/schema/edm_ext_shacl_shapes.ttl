@prefix :          <http://www.europeana.eu/metis/edm/ext/> .
@prefix cc:        <http://creativecommons.org/ns#> .
@prefix dc:        <http://purl.org/dc/elements/1.1/> .
@prefix dcterms:   <http://purl.org/dc/terms/> .
@prefix doap:      <http://usefulinc.com/ns/doap#> .
@prefix edm:       <http://www.europeana.eu/schemas/edm/> .
@prefix foaf:      <http://xmlns.com/foaf/0.1/> .
@prefix odrl:      <http://www.w3.org/ns/odrl/2/> .
@prefix ore:       <http://www.openarchives.org/ore/terms/> .
@prefix owl:       <http://www.w3.org/2002/07/owl#> .
@prefix rdaGr2:    <http://rdvocab.info/ElementsGr2/> .
@prefix rdf:       <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:      <http://www.w3.org/2000/01/rdf-schema#> .
@prefix sh:        <http://www.w3.org/ns/shacl#> .
@prefix skos:      <http://www.w3.org/2004/02/skos/core#> .
@prefix svcs:      <http://rdfs.org/sioc/services#> .
@prefix xsd:       <http://www.w3.org/2001/XMLSchema#> .
@prefix wgs84_pos: <http://www.w3.org/2003/01/geo/wgs84_pos#> .


############################
### Property definitions ###
############################

# These shapes define the properties including their value type and any literal value restrictions.
# Note: by themselves these don't do anything. They need to be used in node shapes for resources.

# Set the message and conditions for a string literal or IRI property definition.
:StringLiteralOrIRIProperty
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:message ;
                      owl:hasValue   "This property must be a string literal or a reference." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:datatype xsd:string ]
                                               [ sh:datatype rdf:langString ]
                                               [ sh:nodeKind sh:IRI ] ) ] ] .

# Set the message and conditions for a string literal property definition.
:StringLiteralProperty
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:message ;
                      owl:hasValue   "This property must be a string literal." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:datatype xsd:string ]
                                               [ sh:datatype rdf:langString ] ) ] ] .

# Set the message and conditions for an IRI property definition.
:IRIProperty
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:message ;
                      owl:hasValue   "This property must be a reference." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:nodeKind sh:IRI ] ] .

# Set the message and conditions for a string literal or decimal property definition.
# TODO These properties should be encouraged to be decimal - but does our pipeline support it?
:StringOrDecimalLiteralProperty
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:message ;
                      owl:hasValue   "This property must be a floating point (decimal)." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:datatype xsd:string ]
                                               [ sh:datatype xsd:decimal ] ) ] ] .

:ccDeprecatedOnProperty
    sh:path     cc:deprecatedOn ;
    sh:datatype xsd:date ;
    sh:message  "This property must be a literal of type 'date'." .

:dcContributorProperty
    sh:path dc:contributor ;
    a       :StringLiteralOrIRIProperty .

:dcCoverageProperty
    sh:path dc:coverage ;
    a       :StringLiteralOrIRIProperty .

:dcCreatorProperty
    sh:path dc:creator ;
    a       :StringLiteralOrIRIProperty .

:dcDateProperty
    sh:path dc:date ;
    a       :StringLiteralOrIRIProperty .

:dcDescriptionProperty
    sh:path dc:description ;
    a       :StringLiteralOrIRIProperty .

:dcFormatProperty
    sh:path dc:format ;
    a       :StringLiteralOrIRIProperty .

:dcIdentifierProperty
    sh:path dc:identifier ;
    a       :StringLiteralProperty .

:dcLanguageProperty
    sh:path dc:language ;
    a       :StringLiteralProperty .

:dcPublisherProperty
    sh:path dc:publisher ;
    a       :StringLiteralOrIRIProperty .

:dcRelationProperty
    sh:path dc:relation ;
    a       :StringLiteralOrIRIProperty .

:dcRightsProperty
    sh:path dc:rights ;
    a       :StringLiteralOrIRIProperty .

:dcSourceProperty
    sh:path dc:source ;
    a       :StringLiteralOrIRIProperty .

:dcSubjectProperty
    sh:path dc:subject ;
    a       :StringLiteralOrIRIProperty .

:dcTitleProperty
    sh:path dc:title ;
    a       :StringLiteralProperty .

:dcTypeProperty
    sh:path dc:type ;
    a       :StringLiteralOrIRIProperty .

:dctermsAlternativeProperty
    sh:path dcterms:alternative ;
    a       :StringLiteralProperty .

:dctermsConformsToProperty
    sh:path dcterms:conformsTo ;
    a       :StringLiteralOrIRIProperty .

:dctermsCreatedProperty
    sh:path dcterms:created ;
    a       :StringLiteralOrIRIProperty .

:dctermsExtentProperty
    sh:path dcterms:extent ;
    a       :StringLiteralOrIRIProperty .

:dctermsHasFormatProperty
    sh:path dcterms:hasFormat ;
    a       :StringLiteralOrIRIProperty .

:dctermsHasPartProperty
    sh:path dcterms:hasPart ;
    a       :StringLiteralOrIRIProperty .

:dctermsHasVersionProperty
    sh:path dcterms:hasVersion ;
    a       :StringLiteralOrIRIProperty .

:dctermsIsFormatOfProperty
    sh:path dcterms:isFormatOf ;
    a       :StringLiteralOrIRIProperty .

:dctermsIsPartOfProperty
    sh:path dcterms:isPartOf ;
    a       :StringLiteralOrIRIProperty .

:dctermsIsReferencedByProperty
    sh:path dcterms:isReferencedBy ;
    a       :StringLiteralOrIRIProperty .

:dctermsIsReplacedByProperty
    sh:path dcterms:isReplacedBy ;
    a       :StringLiteralOrIRIProperty .

:dctermsIsRepuiredByProperty
    sh:path dcterms:isRequiredBy ;
    a       :StringLiteralOrIRIProperty .

:dctermsIssuedProperty
    sh:path dcterms:issued ;
    a       :StringLiteralOrIRIProperty .

:dctermsIsVersionOfProperty
    sh:path dcterms:isVersionOf ;
    a       :StringLiteralOrIRIProperty .

:dctermsMediumProperty
    sh:path dcterms:medium ;
    a       :StringLiteralOrIRIProperty .

:dctermsProvenanceProperty
    sh:path dcterms:provenance ;
    a       :StringLiteralOrIRIProperty .

:dctermsReferencesProperty
    sh:path dcterms:references ;
    a       :StringLiteralOrIRIProperty .

:dctermsReplacesProperty
    sh:path dcterms:replaces ;
    a       :StringLiteralOrIRIProperty .

:dctermsRequiresProperty
    sh:path dcterms:requires ;
    a       :StringLiteralOrIRIProperty .

:dctermsSpatialProperty
    sh:path dcterms:spatial ;
    a       :StringLiteralOrIRIProperty .

:dctermsTableOfContentsProperty
    sh:path dcterms:tableOfContents ;
    a       :StringLiteralProperty .

:dctermsTemporalProperty
    sh:path dcterms:temporal ;
    a       :StringLiteralOrIRIProperty .

:doapImplementsProperty
    sh:path doap:implements ;
    a       :IRIProperty .

:edmAggregatedCHOProperty
    sh:path edm:aggregatedCHO ;
    a       :IRIProperty .

:edmCurrentLocationProperty
    sh:path edm:currentLocation ;
    a       :StringLiteralOrIRIProperty .

:edmDataProviderProperty
    sh:path edm:dataProvider ;
    a       :StringLiteralOrIRIProperty .

:edmBeginProperty
    sh:path edm:begin ;
    a       :StringLiteralProperty .

:edmEndProperty
    sh:path edm:end ;
    a       :StringLiteralProperty .

:edmHasMetProperty
    sh:path edm:hasMet ;
    a       :IRIProperty .

:edmHasTypeProperty
    sh:path edm:hasType ;
    a       :StringLiteralOrIRIProperty .

:edmHasViewProperty
    sh:path edm:hasView ;
    a       :IRIProperty .

:edmIncorporatesProperty
    sh:path edm:incorporates ;
    a       :IRIProperty .

:edmIntermediateProviderProperty
    sh:path edm:intermediateProvider ;
    a       :StringLiteralOrIRIProperty .

:edmIsDerivativeOfProperty
    sh:path edm:isDerivativeOf ;
    a       :IRIProperty .

:edmIsNextInSequenceProperty
    sh:path edm:isNextInSequence ;
    a       :IRIProperty .

:edmIsRelatedToProperty
    sh:path edm:isRelatedTo ;
    a       :StringLiteralOrIRIProperty .

:edmIsRepresentationOfProperty
    sh:path edm:isRepresentationOf ;
    a       :IRIProperty .

:edmIsShownAtProperty
    sh:path edm:isShownAt ;
    a       :IRIProperty .

:edmIsShownByProperty
    sh:path edm:isShownBy ;
    a       :IRIProperty .

:edmIsSimilarToProperty
    sh:path edm:isSimilarTo ;
    a       :IRIProperty .

:edmIsSuccessorOfProperty
    sh:path edm:isSuccessorOf ;
    a       :IRIProperty .

:edmObjectProperty
    sh:path edm:object ;
    a       :IRIProperty .

:edmProviderProperty
    sh:path edm:provider ;
    a       :StringLiteralOrIRIProperty .

:edmRealizesProperty
    sh:path edm:realizes ;
    a       :IRIProperty .

:edmRightsProperty
    sh:path edm:rights ;
    a       :IRIProperty .

:edmTypeProperty
    sh:path     edm:type ;
    sh:datatype xsd:string ;
    sh:in       ( "TEXT" "VIDEO" "SOUND" "IMAGE" "3D" ) ;
    sh:message  "edm:type must have one of the permitted literal values." .

:edmUgcProperty
    sh:path     edm:ugc ;
    sh:datatype xsd:string ;
    sh:pattern  "^true$" ;
    sh:message  "edm:ugc must be a string literal with value 'true'." .

:foafNameProperty
    sh:path foaf:name ;
    a       :StringLiteralProperty .

# TODO Europeana has a controlled list for permissible values.
:odrlInheritFromProperty
    sh:path odrl:inheritFrom ;
    a       :IRIProperty .

:owlSameAsProperty
    sh:path owl:sameAs ;
    a       :IRIProperty .

:rdaGr2BiographicalInformation
    sh:path rdaGr2:biographicalInformation ;
    a       :StringLiteralProperty .

:rdaGr2DateOfBirth
    sh:path rdaGr2:dateOfBirth ;
    a       :StringLiteralProperty .

:rdaGr2DateOfDeath
    sh:path rdaGr2:dateOfDeath ;
    a       :StringLiteralProperty .

:rdaGr2DateOfEstablishment
    sh:path rdaGr2:dateOfEstablishment ;
    a       :StringLiteralProperty .

:rdaGr2DateOfTermination
    sh:path rdaGr2:dateOfTermination ;
    a       :StringLiteralProperty .

:rdaGr2Gender
    sh:path rdaGr2:gender ;
    a       :StringLiteralProperty .

:rdaGr2PlaceOfBirth
    sh:path rdaGr2:placeOfBirth ;
    a       :StringLiteralOrIRIProperty .

:rdaGr2PlaceOfDeath
    sh:path rdaGr2:placeOfDeath ;
    a       :StringLiteralOrIRIProperty .

:rdaGr2ProfessionOrOccupation
    sh:path rdaGr2:professionOrOccupation ;
    a       :StringLiteralOrIRIProperty .

:rdfsLabelProperty
    sh:path rdfs:label ;
    a       :StringLiteralProperty .

:skosAltLabelProperty
    sh:path skos:altLabel ;
    a       :StringLiteralProperty .

:skosBroaderProperty
    sh:path skos:broader ;
    a       :IRIProperty .

:skosBroadMatchProperty
    sh:path skos:broadMatch ;
    a       :IRIProperty .

:skosCloseMatchProperty
    sh:path skos:closeMatch ;
    a       :IRIProperty .

:skosExactMatchProperty
    sh:path skos:exactMatch ;
    a       :IRIProperty .

:skosInSchemeProperty
    sh:path skos:inScheme ;
    a       :IRIProperty .

:skosNarrowerProperty
    sh:path skos:narrower ;
    a       :IRIProperty .

:skosNarrowMatchProperty
    sh:path skos:narrowMatch ;
    a       :IRIProperty .

:skosNotationProperty
    sh:path     skos:notation ;
    sh:nodeKind sh:Literal ;
    sh:message  "skos:notation must be a literal of any type." .

:skosNoteProperty
    sh:path skos:note ;
    a       :StringLiteralProperty .

:skosPrefLabelProperty
    sh:path skos:prefLabel ;
    a       :StringLiteralProperty .

:skosRelatedProperty
    sh:path skos:related ;
    a       :IRIProperty .

:skosRelatedMatchProperty
    sh:path skos:relatedMatch ;
    a       :IRIProperty .

:svcsHasServiceProperty
    sh:path svcs:has_service ;
    a       :IRIProperty .

:wgs84PosLatProperty
    sh:path wgs84_pos:lat ;
    a       :StringOrDecimalLiteralProperty .

:wgs84PosLongProperty
    sh:path wgs84_pos:long ;
    a       :StringOrDecimalLiteralProperty .

:wgs84PosAltProperty
    sh:path wgs84_pos:alt ;
    a       :StringOrDecimalLiteralProperty .


############################
### Resource definitions ###
############################

# These are the closed lists of supported and permitted properties for each resource type.

:ProvidedCHOShape
    a                    sh:NodeShape ;
    sh:targetClass       edm:ProvidedCHO ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:message           "This edm:ProvidedCho object contains unexpected properties." ;
    sh:property          :dcContributorProperty ;
    sh:property          :dcCoverageProperty ;
    sh:property          :dcCreatorProperty ;
    sh:property          :dcDateProperty ;
    sh:property          :dcDescriptionProperty ;
    sh:property          :dcFormatProperty ;
    sh:property          :dcIdentifierProperty ;
    sh:property          :dcLanguageProperty ;
    sh:property          :dcPublisherProperty ;
    sh:property          :dcRelationProperty ;
    sh:property          :dcRightsProperty ;
    sh:property          :dcSourceProperty ;
    sh:property          :dcSubjectProperty ;
    sh:property          :dcTitleProperty ;
    sh:property          :dcTypeProperty ;
    sh:property          :dctermsAlternativeProperty ;
    sh:property          :dctermsConformsToProperty ;
    sh:property          :dctermsCreatedProperty ;
    sh:property          :dctermsExtentProperty ;
    sh:property          :dctermsHasFormatProperty ;
    sh:property          :dctermsHasPartProperty ;
    sh:property          :dctermsHasVersionProperty ;
    sh:property          :dctermsIsFormatOfProperty ;
    sh:property          :dctermsIsPartOfProperty ;
    sh:property          :dctermsIsReferencedByProperty ;
    sh:property          :dctermsIsReplacedByProperty ;
    sh:property          :dctermsIsRepuiredByProperty ;
    sh:property          :dctermsIssuedProperty ;
    sh:property          :dctermsIsVersionOfProperty ;
    sh:property          :dctermsMediumProperty ;
    sh:property          :dctermsProvenanceProperty ;
    sh:property          :dctermsReferencesProperty ;
    sh:property          :dctermsReplacesProperty ;
    sh:property          :dctermsRequiresProperty ;
    sh:property          :dctermsSpatialProperty ;
    sh:property          :dctermsTableOfContentsProperty ;
    sh:property          :dctermsTemporalProperty ;
    sh:property          :edmCurrentLocationProperty ;
    sh:property          :edmHasMetProperty ;
    sh:property          :edmHasTypeProperty ;
    sh:property          :edmIncorporatesProperty ;
    sh:property          :edmIsDerivativeOfProperty ;
    sh:property          :edmIsNextInSequenceProperty ;
    sh:property          :edmIsRelatedToProperty ;
    sh:property          :edmIsRepresentationOfProperty ;
    sh:property          :edmIsSimilarToProperty ;
    sh:property          :edmIsSuccessorOfProperty ;
    sh:property          :edmRealizesProperty ;
    sh:property          :edmTypeProperty ;
    sh:property          :owlSameAsProperty .

:AggregationShape
    a                    sh:NodeShape ;
    sh:targetClass       ore:Aggregation ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:message           "This ore:Aggregation object contains unexpected properties." ;
    sh:property          :dcRightsProperty ;
    sh:property          :edmAggregatedCHOProperty ;
    sh:property          :edmDataProviderProperty ;
    sh:property          :edmHasViewProperty ;
    sh:property          :edmIntermediateProviderProperty ;
    sh:property          :edmIsShownAtProperty ;
    sh:property          :edmIsShownByProperty ;
    sh:property          :edmObjectProperty ;
    sh:property          :edmProviderProperty ;
    sh:property          :edmRightsProperty ;
    sh:property          :edmUgcProperty.

:WebResourceShape
    a                    sh:NodeShape ;
    sh:targetClass       edm:WebResource ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:message           "This edm:WebResource object contains unexpected properties." ;
    sh:property          :dcCreatorProperty ;
    sh:property          :dcDescriptionProperty ;
    sh:property          :dcFormatProperty ;
    sh:property          :dcRightsProperty ;
    sh:property          :dcSourceProperty ;
    sh:property          :dcTypeProperty ;
    sh:property          :dctermsConformsToProperty ;
    sh:property          :dctermsCreatedProperty ;
    sh:property          :dctermsExtentProperty ;
    sh:property          :dctermsHasPartProperty ;
    sh:property          :dctermsIsFormatOfProperty ;
    sh:property          :dctermsIsPartOfProperty ;
    sh:property          :dctermsIsReferencedByProperty ;
    sh:property          :dctermsIssuedProperty ;
    sh:property          :edmIsNextInSequenceProperty ;
    sh:property          :edmRightsProperty ;
    sh:property          :owlSameAsProperty ;
    sh:property          :svcsHasServiceProperty .

:AgentShape
    a                    sh:NodeShape ;
    sh:targetClass       edm:Agent ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property          :dcDateProperty ;
    sh:property          :dcIdentifierProperty ;
    sh:property          :dctermsHasPartProperty ;
    sh:property          :dctermsIsPartOfProperty ;
    sh:property          :edmBeginProperty ;
    sh:property          :edmEndProperty ;
    sh:property          :edmHasMetProperty ;
    sh:property          :edmIsRelatedToProperty ;
    sh:property          :foafNameProperty ;
    sh:property          :owlSameAsProperty ;
    sh:property          :rdaGr2BiographicalInformation ;
    sh:property          :rdaGr2DateOfBirth ;
    sh:property          :rdaGr2DateOfDeath ;
    sh:property          :rdaGr2DateOfEstablishment ;
    sh:property          :rdaGr2DateOfTermination ;
    sh:property          :rdaGr2Gender ;
    sh:property          :rdaGr2PlaceOfBirth ;
    sh:property          :rdaGr2PlaceOfDeath ;
    sh:property          :rdaGr2ProfessionOrOccupation ;
    sh:property          :skosAltLabelProperty ;
    sh:property          :skosNoteProperty ;
    sh:property          :skosPrefLabelProperty .

:ConceptShape
    a                    sh:NodeShape ;
    sh:targetClass       skos:Concept ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property          :skosPrefLabelProperty ;
    sh:property          :skosAltLabelProperty ;
    sh:property          :skosBroaderProperty ;
    sh:property          :skosNarrowerProperty ;
    sh:property          :skosRelatedProperty ;
    sh:property          :skosBroadMatchProperty ;
    sh:property          :skosNarrowMatchProperty ;
    sh:property          :skosRelatedMatchProperty ;
    sh:property          :skosExactMatchProperty ;
    sh:property          :skosCloseMatchProperty ;
    sh:property          :skosNoteProperty ;
    sh:property          :skosNotationProperty ;
    sh:property          :skosInSchemeProperty .

:PlaceShape
    a                    sh:NodeShape ;
    sh:targetClass       edm:Place ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property          :wgs84PosLatProperty ;
    sh:property          :wgs84PosLongProperty ;
    sh:property          :wgs84PosAltProperty ;
    sh:property          :skosPrefLabelProperty ;
    sh:property          :skosAltLabelProperty ;
    sh:property          :skosNoteProperty ;
    sh:property          :dctermsHasPartProperty ;
    sh:property          :dctermsIsPartOfProperty ;
    sh:property          :edmIsNextInSequenceProperty ;
    sh:property          :owlSameAsProperty .

:TimeSpanShape
    a                    sh:NodeShape ;
    sh:targetClass       edm:TimeSpan ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property          :skosPrefLabelProperty ;
    sh:property          :skosAltLabelProperty ;
    sh:property          :skosNoteProperty ;
    sh:property          :dctermsHasPartProperty ;
    sh:property          :dctermsIsPartOfProperty ;
    sh:property          :edmBeginProperty ;
    sh:property          :edmEndProperty ;
    sh:property          :edmIsNextInSequenceProperty ;
    sh:property          :skosNotationProperty ;
    sh:property          :owlSameAsProperty .

:LicenseShape
    a                    sh:NodeShape ;
    sh:targetClass       cc:License ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property          :odrlInheritFromProperty ;
    sh:property          :ccDeprecatedOnProperty .

:ServiceShape
    a                    sh:NodeShape ;
    sh:targetClass       svcs:Service ;
    sh:closed            true ;
    sh:ignoredProperties ( rdf:type ) ;
    sh:property          :dctermsConformsToProperty ;
    sh:property          :doapImplementsProperty ;
    sh:property          :rdfsLabelProperty .

###############################
### IRI target restrictions ###
###############################

# These shapes define the target type (range) of IRI references. These shapes verify that the
# various properties reference the right type of classes. The typing conditions for contextual
# class references are designed to avoid failing on literals, or on IRIs that are not resolvable
# in the record.

# TODO in the following checks, this schema follows the documentation. But we should verify and adjust.
# TODO check: dc:coverage in the docs can also have timespan, but we enrich only for Place.
# TODO check: fields that are not enriched but could be according to the docs: dc:publisher, ...
# TODO        edm:currentLocation, edm:hasType, edm:isRelatedTo?, dc:relation?
# TODO check: dcterms:medium and dc:format is enriched as if it always has a Concept, but this is
# TODO        not clear from the docs. However, it is kind of implied in the EDM definition.
# TODO check: Organization objects (and references to them) are not expected in EDM external?
# TODO check: dc:description can be a reference. To what?

# TODO check: The acceptable referenced classes/objects for each property. Where the documentation
# TODO        it says '(related) resource' it is assumed to be a resource on the web somewhere.
# TODO        So we need to check at least all references that are marked as non-EDM or
# TODO        ProvidedCHO references.

# TODO Nuno is working on formalizing the range description of the various properties.

# Conditions with a lesser severity level.
:ConditionWithLesserSeverity
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:severity ;
                      owl:hasValue   sh:Warning ] .

# Set the message and conditions for an Agent reference definition.
:AgentReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property should not reference an EDM class other than edm:Agent." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:class edm:Agent ]
                                               [ sh:not [ sh:class :EdmClass ] ] ) ] ] .

# Set the message and conditions for a Concept reference definition.
:ConceptReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property should not reference an EDM class other than skos:Concept." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:class skos:Concept ]
                                               [ sh:not [ sh:class :EdmClass ] ] ) ] ] .

# Set the message and conditions for a non-EDM reference definition.
:NonEdmReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property should not reference an EDM class." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:not [ sh:class :EdmClass ] ] ] .

# Set the message and conditions for an Organisation reference definition.
:OrganisationReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property relates to Organizations and should not reference an EDM-external class." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:not [ sh:class :EdmClass ] ] ] .

# Set the message and conditions for a Place reference definition.
:PlaceReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property should not reference an EDM class other than edm:Place." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:class edm:Place ]
                                               [ sh:not [ sh:class :EdmClass ] ] ) ] ] .

# Set the message and conditions for a 'related resource' reference definition.
:ProvidedCHOReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property should not reference an EDM class other than edm:ProvidedCHO." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:class edm:ProvidedCHO ]
                                               [ sh:not [ sh:class :EdmClass ] ] ) ] ] .
# Set the message and conditions for a TimeSpan reference definition.
:TimeSpanReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property should not reference an EDM class other than edm:TimeSpan." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:class edm:TimeSpan ]
                                               [ sh:not [ sh:class :EdmClass ] ] ) ] ] .

# Set the message and conditions for a Web Resource reference definition.
:WebResourceReference
    rdfs:subClassOf :ConditionWithLesserSeverity ;
    rdfs:subClassOf [ owl:onProperty sh:message ;
                      owl:hasValue   "This property should not reference an EDM class other than edm:WebResource." ] ;
    rdfs:subClassOf [ a              owl:Restriction ;
                      owl:onProperty sh:node ;
                      owl:hasValue   [ sh:or ( [ sh:class edm:WebResource ]
                                               [ sh:not [ sh:class :EdmClass ] ] ) ] ] .

# Properties for which the references are always the same type, regardless of the subject type.
:EdmClassWithCorrectReferencesShape
    a              sh:NodeShape ;
    sh:targetClass :EdmClass ;
    sh:property    [ sh:path dc:contributor ;
                     a       :AgentReference ] ;
    sh:property    [ sh:path     dc:coverage ;
                     sh:or       ( [ sh:class edm:Place ]
                                   [ sh:class edm:TimeSpan ]
                                   [ sh:not [ sh:class :EdmClass ] ] ) ;
                     sh:severity sh:Warning ;
                     sh:message  "This property should not reference an EDM class other than edm:Place or edm:TimeSpan." ] ;
    sh:property    [ sh:path dc:creator ;
                     a       :AgentReference ] ;
    sh:property    [ sh:path dc:date ;
                     a       :TimeSpanReference ] ;
    sh:property    [ sh:path dc:description ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path dc:format ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path dc:publisher ;
                     a       :AgentReference ] ;
    sh:property    [ sh:path dc:relation ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dc:rights ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path dc:source ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dc:subject ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path dc:type ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path dcterms:conformsTo ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path dcterms:created ;
                     a       :TimeSpanReference ] ;
    sh:property    [ sh:path dcterms:extent ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path dcterms:hasFormat ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path dcterms:hasVersion ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:issued ;
                     a       :TimeSpanReference ] ;
    sh:property    [ sh:path dcterms:isReferencedBy ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:isReplacedBy ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:isRequiredBy ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:isVersionOf ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:medium ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path dcterms:provenance ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path dcterms:references ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:replaces ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:requires ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:spatial ;
                     a       :PlaceReference ] ;
    sh:property    [ sh:path dcterms:temporal ;
                     a       :TimeSpanReference ] ;
    sh:property    [ sh:path doap:implements ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path    edm:aggregatedCHO ;
                     sh:class   edm:ProvidedCHO ;
                     sh:message "edm:aggregatedCHO must reference an edm:ProvidedCHO." ] ;
    sh:property    [ sh:path edm:currentLocation ;
                     a       :PlaceReference ] ;
    sh:property    [ sh:path edm:dataProvider ;
                     a       :OrganisationReference ] ;
    sh:property    [ sh:path     edm:hasMet ;
                     sh:or       ( [ sh:class :ContextualClass ]
                                   [ sh:not [ sh:class :EdmClass ] ] ) ;
                     sh:severity sh:Warning ;
                     sh:message  "This property should not reference an EDM class other than a contextual entity." ] ;
    sh:property    [ sh:path edm:hasView ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path edm:hasType ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path edm:incorporates ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path edm:intermediateProvider ;
                     a       :OrganisationReference ] ;
    sh:property    [ sh:path edm:isDerivativeOf ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path edm:isRepresentationOf ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path edm:isShownAt ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path edm:isShownBy ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path edm:isSimilarTo ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path edm:isSuccessorOf ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path edm:object ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path edm:provider ;
                     a       :OrganisationReference ] ;
    sh:property    [ sh:path edm:realizes ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path     edm:rights ;
                     sh:or       ( [ sh:class cc:License ]
                                   [ sh:not [ sh:class :EdmClass ] ] ) ;
                     sh:severity sh:Warning ;
                     sh:message  "This property should not reference an EDM class other than cc:License." ] ;
    sh:property    [ sh:path odrl:inheritFrom ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path rdaGr2:placeOfBirth ;
                     a       :PlaceReference ] ;
    sh:property    [ sh:path rdaGr2:placeOfDeath ;
                     a       :PlaceReference ] ;
    sh:property    [ sh:path rdaGr2:professionOrOccupation ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:broader ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:broadMatch ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:closeMatch ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:exactMatch ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:inScheme ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path skos:narrower ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:narrowMatch ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:related ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path skos:relatedMatch ;
                     a       :ConceptReference ] ;
    sh:property    [ sh:path     svcs:has_service ;
                     sh:class    svcs:Service ;
                     sh:severity sh:Warning ;
                     sh:message  "svcs:has_service must reference an svcs:Service." ] .

# Provided CHO properties for which the references are dependent on the subject type.
:ProvidedCHOWithCorrectReferencesShape
    a              sh:NodeShape ;
    sh:targetClass edm:ProvidedCHO ;
    sh:property    [ sh:path dcterms:hasPart ;
                     a       :ProvidedCHOReference ] ;
    sh:property    [ sh:path dcterms:isFormatOf ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path dcterms:isPartOf ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path edm:isNextInSequence ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path owl:sameAs ;
                     a       :NonEdmReference ] ;
    sh:property    [ sh:path     edm:isRelatedTo ;
                     sh:or       ( [ sh:class edm:ProvidedCHO ]
                                   [ sh:class skos:Concept ]
                                   [ sh:not [ sh:class :EdmClass ] ] ) ;
                     sh:severity sh:Warning ;
                     sh:message  "This property should not reference an EDM class other than edm:ProvidedCHO or skos:Concept." ] .

# Web Resource properties for which the references are dependent on the subject type.
:WebResourceWithCorrectReferencesShape
    a              sh:NodeShape ;
    sh:targetClass edm:WebResource ;
    sh:property    [ sh:path dcterms:hasPart ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path dcterms:isFormatOf ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path dcterms:isPartOf ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path edm:isNextInSequence ;
                     a       :WebResourceReference ] ;
    sh:property    [ sh:path owl:sameAs ;
                     a       :WebResourceReference ] .

# Agent properties for which the references are dependent on the subject type.
:AgentWithCorrectReferencesShape
    a              sh:NodeShape ;
    sh:targetClass edm:Agent ;
    sh:property    [ sh:path dcterms:hasPart ;
                     a       :AgentReference ] ;
    sh:property    [ sh:path dcterms:isPartOf ;
                     a       :AgentReference ] ;
    sh:property    [ sh:path     edm:isRelatedTo ;
                     sh:or       ( [ sh:class :ContextualClass ]
                                   [ sh:not [ sh:class :EdmClass ] ] ) ;
                     sh:severity sh:Warning ;
                     sh:message  "This property should not reference an EDM class other than a contextual entity." ] ;
    sh:property    [ sh:path owl:sameAs ;
                     a       :AgentReference ] .

# Place properties for which the references are dependent on the subject type.
:PlaceWithCorrectReferencesShape
    a              sh:NodeShape ;
    sh:targetClass edm:Place ;
    sh:property    [ sh:path dcterms:hasPart ;
                     a       :PlaceReference ] ;
    sh:property    [ sh:path dcterms:isPartOf ;
                     a       :PlaceReference ] ;
    sh:property    [ sh:path edm:isNextInSequence ;
                     a       :PlaceReference ] ;
    sh:property    [ sh:path owl:sameAs ;
                     a       :PlaceReference ] .

:ServiceWithCorrectReferencesShape
    a              sh:NodeShape ;
    sh:targetClass svcs:Service ;
    sh:property    [ sh:path     dcterms:conformsTo ;
                     sh:nodeKind sh:IRI ;
                     sh:in       ( <http://iiif.io/api/image> <https://oembed.com/> );
                     sh:severity sh:Warning ;
                     sh:message  "This Service conforms to an unrecognised standard." ] .

# Timespan properties for which the references are dependent on the subject type.
:TimeSpanWithCorrectReferencesShape
    a              sh:NodeShape ;
    sh:targetClass edm:TimeSpan ;
    sh:property    [ sh:path dcterms:hasPart ;
                     a       :TimeSpanReference ] ;
    sh:property    [ sh:path dcterms:isPartOf ;
                     a       :TimeSpanReference ] ;
    sh:property    [ sh:path edm:isNextInSequence ;
                     a       :TimeSpanReference ] ;
    sh:property    [ sh:path owl:sameAs ;
                     a       :TimeSpanReference ] .


#########################################
### Property cardinality declarations ###
#########################################

# This includes cardinalities for individual properties, but also for groups of properties (e.g.
# at least one of the following three properties must be present).

# Note: some properties are mandated to be non-empty in the definitions below. These properties are
# involved in specific requirements for presence. If a property (or at least one of a group of
# properties) is required to be present, then it should not be allowed to be empty. This is not
# only out of data correctness, but also to prevent normalisation from invalidating the record.
# During normalisation emtpy properties may be removed and the record could become invalid as a result.
# Note: this only applies when the property is allowed to be a literal.


# ProvidedCHO: There needs to be at least a description or title, and the description should be a
# literal. Also, there needs to be at least a dc:subject, dc:type, dcterms:spatial or dcterms:temporal.
# TODO hasView can only occur if isShownBy has already been used. According to Hugo:check with Nuno. Warning, not violation.
:ProvidedCHOCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass edm:ProvidedCHO ;
    sh:property    [ sh:path       dc:title ;
                     sh:uniqueLang true ;
                     sh:severity   sh:Warning ;
                     sh:message    "There should be only one dc:title value per language. " ] ;
    sh:property    [ sh:path       dc:description ;
                     sh:or         ( [ sh:datatype xsd:string ] [ sh:datatype rdf:langString ] ) ;
                     sh:severity   sh:Warning ;
                     sh:message    "dc:description should be a string literal, not a reference." ] ;
    sh:property    [ sh:path       edm:currentLocation ;
                     sh:maxCount   1 ;
                     sh:message    "edm:currentLocation can only occur once." ] ;
    sh:property    [ sh:path       edm:isRepresentationOf ;
                     sh:maxCount   1 ;
                     sh:message    "edm:isRepresentationOf can only occur once." ] ;
    sh:property    [ sh:path       edm:type ;
                     sh:minCount   1 ;
                     sh:maxCount   1 ;
                     sh:message    "edm:type must occur exactly once." ] ;
    sh:property    [ sh:path                [ sh:alternativePath ( dc:title dc:description ) ] ;
                     sh:qualifiedValueShape [ sh:pattern "\\S" ] ;
                     sh:qualifiedMinCount   1 ;
                     sh:message             "At least one the following properties must be present and non-whitespace: dc:title or dc:description." ] ;
    sh:property    [ sh:path                [ sh:alternativePath ( dc:subject dc:type dcterms:spatial dcterms:temporal ) ] ;
                     sh:qualifiedValueShape [ sh:pattern "\\S" ] ;
                     sh:qualifiedMinCount   1 ;
                     sh:message             "At least one the following properties should be present and non-empty: dc:subject, dc:type, dcterms:spatial or dcterms:temporal." ] .

# ProvidedCHO: If this is a TEXT object, we require a language.
:ProvidedCHOForTextWithLanguageShape
    a              sh:NodeShape ;
    sh:targetClass edm:ProvidedCHO ;
    sh:or          ( [ sh:path                dc:language ;
                       sh:qualifiedValueShape [ sh:pattern "\\S" ] ;
                       sh:qualifiedMinCount   1 ]
                     [ sh:not [ sh:path    edm:type ;
                                sh:pattern "^TEXT$" ] ] ) ;
    sh:message     "At least one non-whitespace occurrence of the property dc:language is required if edm:type='TEXT'." .

# Aggregation: There needs to be at least a edm:isShownAt or edm:isShownBy.
:AggregationCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass ore:Aggregation ;
    sh:property    [ sh:path     edm:aggregatedCHO ;
                     sh:minCount 1 ;
                     sh:maxCount 1 ;
                     sh:message  "edm:aggregatedCHO must be present exactly once." ] ;
    sh:property    [ sh:path     edm:dataProvider ;
                     sh:minCount 1 ;
                     sh:maxCount 1 ;
                     sh:pattern  "\\S" ;
                     sh:message  "edm:dataProvider must occur exactly once and must be non-empty."] ;
    sh:property    [ sh:path     edm:isShownAt ;
                     sh:maxCount 1 ;
                     sh:message  "edm:isShownAt can only occur once." ] ;
    sh:property    [ sh:path     edm:isShownBy ;
                     sh:maxCount 1 ;
                     sh:message  "edm:isShownBy can only occur once." ] ;
    sh:property    [ sh:path     edm:object ;
                     sh:maxCount 1 ;
                     sh:message  "edm:object can only occur once." ] ;
    sh:property    [ sh:path     edm:provider ;
                     sh:minCount 1 ;
                     sh:maxCount 1 ;
                     sh:pattern  "\\S" ;
                     sh:message  "edm:provider must occur exactly once and must be non-empty." ] ;
    sh:property    [ sh:path     edm:rights ;
                     sh:minCount 1 ;
                     sh:maxCount 1 ;
                     sh:message  "edm:rights must occur exactly once." ] ;
    sh:property    [ sh:path     [ sh:alternativePath ( edm:isShownAt edm:isShownBy ) ] ;
                     sh:minCount 1 ;
                     sh:message  "At least one the following properties must be present: edm:isShownAt or edm:isShownBy." ] .

# Aggregation: Warn if an IMAGE has no edm:isShownBy or edm:object.
:AggregationForImageWithRightMediaLinksShape
    a              sh:NodeShape ;
    sh:targetClass ore:Aggregation ;
    sh:or          ( [ sh:path     [ sh:alternativePath ( edm:isShownBy edm:object ) ] ;
                       sh:minCount 1 ]
                     [ sh:not      [ sh:path    ( edm:aggregatedCHO edm:type ) ;
                                     sh:pattern "^IMAGE$" ] ] ) ;
    sh:severity    sh:Warning ;
    sh:message     "At least one of edm:isShownBy or edm:object is required for publication if edm:type='IMAGE'." .

:WebResourceCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass edm:WebResource ;
    sh:property    [ sh:path     edm:rights ;
                     sh:maxCount 1 ;
                     sh:message  "edm:rights may only occur once." ] .

# Contextual classes
:ContextualClassCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass :ContextualClass ;
    sh:property    [ sh:path                skos:prefLabel ;
                     sh:qualifiedValueShape [ sh:pattern "\\S" ] ;
                     sh:qualifiedMinCount   1 ;
                     sh:severity            sh:Warning ;
                     sh:message             "There should be at least one non-empty skos:prefLabel." ] ;
    sh:property    [ sh:path       skos:prefLabel ;
                     sh:uniqueLang true ;
                     sh:severity   sh:Warning ;
                     sh:message    "There should be at most one skos:prefLabel value per language." ] .

:AgentCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass edm:Agent ;
    sh:property    [ sh:path     edm:begin ;
                     sh:maxCount 1 ;
                     sh:message  "edm:begin can only occur once." ] ;
    sh:property    [ sh:path     edm:end ;
                     sh:maxCount 1 ;
                     sh:message  "edm:end can only occur once." ] ;
    sh:property    [ sh:path     rdaGr2:dateOfBirth ;
                     sh:maxCount 1 ;
                     sh:message  "rdaGr2:dateOfBirth can only occur once." ] ;
    sh:property    [ sh:path     rdaGr2:dateOfDeath ;
                     sh:maxCount 1 ;
                     sh:message  "rdaGr2:dateOfDeath can only occur once." ] ;
    sh:property    [ sh:path     rdaGr2:dateOfEstablishment ;
                     sh:maxCount 1 ;
                     sh:message  "rdaGr2:dateOfEstablishment can only occur once." ] ;
    sh:property    [ sh:path     rdaGr2:dateOfTermination ;
                     sh:maxCount 1 ;
                     sh:message  "rdaGr2:dateOfTermination can only occur once." ] ;
    sh:property    [ sh:path     rdaGr2:gender ;
                     sh:maxCount 1 ;
                     sh:message  "rdaGr2:gender can only occur once." ] ;
    sh:property    [ sh:path     rdaGr2:placeOfBirth ;
                     sh:maxCount 1 ;
                     sh:message  "rdaGr2:placeOfBirth can only occur once." ] ;
    sh:property    [ sh:path     rdaGr2:placeOfDeath ;
                     sh:maxCount 1 ;
                     sh:message  "rdaGr2:placeOfDeath can only occur once." ] .

:PlaceCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass edm:Place ;
    sh:property    [ sh:path     wgs84_pos:lat ;
                     sh:maxCount 1 ;
                     sh:message  "wgs84_pos:lat can only occur once." ] ;
    sh:property    [ sh:path     wgs84_pos:long ;
                     sh:maxCount 1 ;
                     sh:message  "wgs84_pos:long can only occur once." ] ;
    sh:property    [ sh:path     wgs84_pos:alt ;
                     sh:maxCount 1 ;
                     sh:message  "wgs84_pos:alt can only occur once." ] .

:TimeSpanCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass edm:TimeSpan ;
    sh:property    [ sh:path     edm:begin ;
                     sh:maxCount 1 ;
                     sh:message  "edm:begin can only occur once." ] ;
    sh:property    [ sh:path     edm:end ;
                     sh:maxCount 1 ;
                     sh:message  "edm:end can only occur once." ] ;
    sh:property    [ sh:path     skos:notation ;
                     sh:maxCount 1 ;
                     sh:message  "skos:notation can only occur once." ] .

:LicenseCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass cc:License ;
    sh:property    [ sh:path     odrl:inheritFrom ;
                     sh:minCount 1 ;
                     sh:maxCount 1 ;
                     sh:message  "odrl:inheritFrom must occur exactly once." ] ;
    sh:property    [ sh:path     cc:deprecatedOn ;
                     sh:maxCount 1 ;
                     sh:message  "cc:deprecatedOn can only occur once." ] .

:ServiceCardinalitiesShape
    a              sh:NodeShape ;
    sh:targetClass svcs:Service ;
    sh:property    [ sh:path     dcterms:conformsTo ;
                     sh:minCount 1 ;
                     sh:message  "dcterms:conformsTo must occur at least once." ] ;
    sh:property    [ sh:path     doap:implements ;
                     sh:maxCount 1 ;
                     sh:message  "doap:implements can only occur once." ] .

:ServiceWithLabelShape
    a              sh:NodeShape ;
    sh:targetClass svcs:Service ;
    sh:or          ( [ sh:path     rdfs:label ;
                       sh:qualifiedValueShape [ sh:pattern "\\S" ] ;
                       sh:qualifiedMinCount   1 ]
                     [ sh:not      [ sh:path    ( dcterms:conformsTo ) ;
                                     sh:hasValue <https://oembed.com/> ] ] ) ;
    sh:severity    sh:Warning ;
    sh:message     "An oEmbed-compliant service should have a non-empty rdfs:label value." .
